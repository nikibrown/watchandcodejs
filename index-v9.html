<html>
	<head>
		<title>Version 9 - Escape from the console</title>
	</head>
	<body>
		<h1>Todo List!</h1>
		<div>
			<button onclick="handlers.toggleAll()">Toggle All</button>
		</div>
		
		<div>
			<input type="text" id="addTodoTextInput" placeholder="Todo Text">
			<button onclick="handlers.addTodo()">Add</button>
		</div>

		<div>
			<input type="number" id="changeTodoPositionInput" placeholder="Todo Index">
			<input type="text" id="changeTodoTextInput" placeholder="New Todo Text">
			<button onclick="handlers.changeTodo();">Change Todo</button>
		</div>

		<div>
			<input type="number" id="deleteTodoPositionInput" placeholder="Todo Index">
			<button onclick="handlers.deleteTodo();">Delete Todo</button>
		</div>

		<div>
			<input type="number" id="toggleCompletedPositionInput" placeholder="Todo Index">
			<button onclick="handlers.toggleCompleted()">Toggle Completed</button>
		</div>
		
		<ul id="htmlList">
		</ul>

		<script>

		// Version 8 - Refactoring and getting data from inputs

		// Js is at bottom of page to interact with the DOM elements. HTML has to load first (use window.load or document.ready)

			var todoList = {
				todos: [
							{
								todoText: "thing1",
								completed: false
							}, 
							{
								todoText: "thing2",
								completed: false
							}
				], // an array of objects with two properties
				addTodo: function(todoText) {
					this.todos.push({
						todoText: todoText,
						completed: false
					});
				},
				changeTodo: function(position, todoText) {
					this.todos[position].todoText = todoText;
				},
				deleteTodo: function(position) {
					this.todos.splice(position, 1);
				},
				toggleCompleted: function(position) {
					var todo = this.todos[position];
					todo.completed  = !todo.completed;
				},
				toggleAll: function() {
					var totalTodos = this.todos.length;
					var completedTodos = 0;

					for (var i = 0; i < totalTodos; i++) {
						if (this.todos[i].completed === true) {
							completedTodos++;
						}
					}

					if (completedTodos === totalTodos) {
						// Case 1: If everything's true, make everything false
						for (var i = 0; i < totalTodos; i++) {
							this.todos[i].completed = false;
						}
					} else {
						// Case 2: Otherwise, make everything true
						for (var i = 0; i < totalTodos; i++) {
							this.todos[i].completed = true;
						}
					}
				}
			}


			

			// 1. get access to display todos btn
			var displayTodosButton = document.getElementById("displayTodosButton");
			var toggleAllButton = document.getElementById("toggleAllButton");

			
			var htmlList = document.getElementById("htmlList");

			// 2. run displayTodos method when someone clicks the display button

			
			// displayTodosButton.addEventListener('click', function() {
			// 	todoList.displayTodos();
			// });

			// toggleAllButton.addEventListener('click', function() {
			// 	todoList.toggleAll();
			// });



			var handlers = { // handles user interactions
				addTodo: function() {
					var addTodoTextInput = document.getElementById('addTodoTextInput');
					todoList.addTodo(addTodoTextInput.value);
					 addTodoTextInput.value = '';
					 view.displayTodos();
				},
				changeTodo: function() {
					var changeTodoPositionInput = document.getElementById('changeTodoPositionInput');
					var changeTodoTextInput = document.getElementById('changeTodoTextInput');
					todoList.changeTodo(changeTodoPositionInput.valueAsNumber, changeTodoTextInput.value );
					changeTodoPositionInput.value = '';
					changeTodoTextInput.value = '';
					view.displayTodos();
				},
				deleteTodo: function() {
					var deleteTodoPositionInput = document.getElementById('deleteTodoPositionInput');
					todoList.deleteTodo(deleteTodoPositionInput.valueAsNumber);
					deleteTodoPositionInput.value = '';
					view.displayTodos();
				},
				toggleCompleted: function() {
					var toggleCompletedPositionInput = document.getElementById('toggleCompletedPositionInput');
					todoList.toggleCompleted(toggleCompletedPositionInput.valueAsNumber);
					toggleCompletedPositionInput.value = '';
					view.displayTodos();
				},
				toggleAll: function() {
					todoList.toggleAll();
					view.displayTodos();
				}
			};	

			var view = { // responsible for what users see - renders data to the screen
				displayTodos : function() {
					var todosUl = document.querySelector('ul');
					todosUl.innerHTML = '';
					for (var i = 0; i < todoList.todos.length; i++) {
						var todoLi = document.createElement('li');
						var todoTextWithCompletion = ''; // refactored so the (x) is set with a var and todoTet is added in 
						var todo = todoList.todos[i]; // saves us some typing
						
						if (todoList.todos[i].completed == true) {
							var todoTextWithCompletion = '(x) ' + todo.todoText;
						} else {
							var todoTextWithCompletion = '( ) ' + todo.todoText;
						}

						todoLi.textContent = todoTextWithCompletion
						todosUl.appendChild(todoLi);
					}
				}
			}
		</script>
	</body>
</html>